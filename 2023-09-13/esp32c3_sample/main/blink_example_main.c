/* Blink Example

   This example code is in the Public Domain (or CC0 licensed, at your option.)

   Unless required by applicable law or agreed to in writing, this
   software is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
   CONDITIONS OF ANY KIND, either express or implied.
*/
#include <stdio.h>
#include <string.h>
#include "freertos/FreeRTOS.h"
#include "freertos/task.h"
#include "driver/gpio.h"
#include "esp_log.h"
#include "esp_timer.h"
#include "mbedtls/error.h"
#include "mbedtls/rsa.h"
#include "led_strip.h"
#include "sdkconfig.h"
#include "soc/dport_access.h"
#include "soc/hwcrypto_periph.h"
#include "bignum_impl.h"

static const char *TAG = "example";

/* Use project configuration menu (idf.py menuconfig) to choose the GPIO to blink,
   or you can edit the following line and set a number here.
*/
#define BLINK_GPIO CONFIG_BLINK_GPIO

static uint8_t s_led_state = 0;

#ifdef CONFIG_BLINK_LED_RMT

static led_strip_handle_t led_strip;

static void blink_led(void)
{
    /* If the addressable LED is enabled */
    if (s_led_state) {
        /* Set the LED pixel using RGB from 0 (0%) to 255 (100%) for each color */
        led_strip_set_pixel(led_strip, 0, 255, 255, 255);
        /* Refresh the strip to send data */
        led_strip_refresh(led_strip);
    } else {
        /* Set all LED off to clear all pixels */
        led_strip_clear(led_strip);
    }
}

static void configure_led(void)
{
    ESP_LOGI(TAG, "Example configured to blink addressable LED!");
    /* LED strip initialization with the GPIO and pixels number*/
    led_strip_config_t strip_config = {
        .strip_gpio_num = BLINK_GPIO,
        .max_leds = 1, // at least one LED on board
    };
    led_strip_rmt_config_t rmt_config = {
        .resolution_hz = 10 * 1000 * 1000, // 10MHz
    };
    ESP_ERROR_CHECK(led_strip_new_rmt_device(&strip_config, &rmt_config, &led_strip));
    /* Set all LED off to clear all pixels */
    led_strip_clear(led_strip);
}

#elif CONFIG_BLINK_LED_GPIO

static void blink_led(void)
{
    /* Set the GPIO level according to the state (LOW or HIGH)*/
    gpio_set_level(BLINK_GPIO, s_led_state);
}

static void configure_led(void)
{
    ESP_LOGI(TAG, "Example configured to blink GPIO LED!");
    gpio_reset_pin(BLINK_GPIO);
    /* Set the GPIO as a push/pull output */
    gpio_set_direction(BLINK_GPIO, GPIO_MODE_OUTPUT);
    gpio_set_direction(4, GPIO_MODE_OUTPUT);
    gpio_set_direction(5, GPIO_MODE_OUTPUT);
    gpio_set_level(4, 1);
    gpio_set_level(5, 1);
}

#endif

#ifdef RSA_4K_KEY
// https://github.com/openssl/openssl/blob/869d95b00e22b68897a541abf3bcee3589d2d519/crypto/rsa/rsa_ameth.c#L333-L344
static const unsigned char rsa_n[] = {
  0x00, 0xd7, 0x86, 0xf9, 0x2e, 0xff, 0xe3, 0xe2, 0x72, 0xf8, 0xa9, 0xb3,
  0x7e, 0x9c, 0x30, 0x9d, 0x5e, 0x0a, 0xbd, 0x99, 0xdb, 0x9d, 0x7a, 0xce,
  0xfc, 0x10, 0x46, 0x92, 0xa4, 0x9b, 0x3f, 0x8f, 0x13, 0x99, 0x41, 0xef,
  0xab, 0xd4, 0xd5, 0x11, 0x21, 0x22, 0xff, 0xfd, 0x51, 0x02, 0x78, 0xd0,
  0x34, 0x00, 0x7f, 0x9b, 0x64, 0xb8, 0xa8, 0xeb, 0xaf, 0xde, 0xf5, 0xd1,
  0x6e, 0xcd, 0x58, 0x7f, 0x47, 0x0f, 0xbe, 0x65, 0x78, 0xdc, 0x65, 0x87,
  0xad, 0x57, 0x09, 0xe1, 0x32, 0xa0, 0x27, 0xbe, 0x95, 0x4c, 0x72, 0x3c,
  0x77, 0xcc, 0x8a, 0xb4, 0x46, 0xa9, 0x46, 0xda, 0x51, 0x99, 0x3b, 0x49,
  0x4b, 0x1b, 0xeb, 0x21, 0x74, 0xa0, 0xc0, 0x83, 0xc3, 0x44, 0xfa, 0xba,
  0x89, 0xf9, 0x1a, 0x91, 0x9d, 0x3f, 0xaa, 0x30, 0x3f, 0x64, 0xc8, 0x7c,
  0x3e, 0x48, 0x37, 0x91, 0xe9, 0xdd, 0x5a, 0xca, 0x11, 0x46, 0x9d, 0xc5,
  0x7c, 0x68, 0x65, 0x74, 0x1e, 0x69, 0xc6, 0xf4, 0x14, 0x4e, 0x13, 0x0e,
  0xc7, 0xe3, 0x58, 0xef, 0x77, 0x02, 0xf2, 0x9f, 0x0b, 0x50, 0xb4, 0x6c,
  0xc9, 0xe6, 0x8c, 0xdc, 0x2c, 0x15, 0x54, 0x9a, 0x5a, 0x97, 0x5a, 0x57,
  0xbd, 0x22, 0xa3, 0x2b, 0xbb, 0x85, 0x5e, 0xd5, 0xab, 0xbe, 0x02, 0x08,
  0xb1, 0x9d, 0x33, 0xa2, 0x07, 0x76, 0xa9, 0xb6, 0xa2, 0x4d, 0x50, 0xc9,
  0x92, 0x19, 0x7f, 0x46, 0x8f, 0x28, 0x95, 0x61, 0x72, 0x82, 0x29, 0x32,
  0x53, 0x19, 0x37, 0x46, 0xe9, 0x9d, 0x7e, 0x2e, 0x1a, 0xde, 0xbb, 0x8d,
  0x73, 0x5d, 0x49, 0xd6, 0x71, 0x2b, 0x1e, 0x29, 0x19, 0xdc, 0x64, 0x9e,
  0x12, 0x8d, 0x3b, 0xbe, 0x74, 0xf6, 0xbe, 0xb7, 0xe7, 0xae, 0x08, 0xc9,
  0xd0, 0xaf, 0x00, 0x71, 0x93, 0x9e, 0x34, 0xe8, 0xe4, 0xf5, 0x8a, 0x66,
  0xf3, 0x1b, 0x0e, 0x58, 0x17, 0xcb, 0x2e, 0x05, 0x3e, 0x8d, 0x60, 0x30,
  0x17, 0x8b, 0xec, 0x0e, 0xbf, 0xa5, 0x64, 0xf1, 0xc5, 0x36, 0xe3, 0xd9,
  0xab, 0x41, 0x36, 0xa8, 0xd1, 0xa3, 0x29, 0x88, 0xcf, 0x7e, 0x0c, 0x69,
  0xa2, 0x97, 0xf5, 0x21, 0x44, 0x15, 0x55, 0x03, 0x99, 0x26, 0x07, 0x53,
  0xd8, 0x4d, 0xc9, 0x78, 0x42, 0xff, 0xb2, 0x76, 0xec, 0xeb, 0xd9, 0xde,
  0x5b, 0xf3, 0xe7, 0xaa, 0x5b, 0xc5, 0xb5, 0xbf, 0x5a, 0xe9, 0x83, 0xec,
  0xc0, 0xd5, 0xec, 0xba, 0x54, 0x3a, 0x2d, 0xdf, 0x29, 0x06, 0x79, 0xd0,
  0x42, 0x22, 0x10, 0xaa, 0x3a, 0xcd, 0x8d, 0x89, 0xb4, 0xc3, 0x3a, 0x38,
  0x86, 0x21, 0xeb, 0x16, 0x9f, 0x51, 0xf5, 0x66, 0xd9, 0x53, 0xec, 0x26,
  0x82, 0x89, 0xd2, 0x0f, 0x21, 0xfe, 0xfe, 0xad, 0xc5, 0xb9, 0x02, 0xbc,
  0x26, 0xb5, 0x55, 0xc5, 0x53, 0xb3, 0x2d, 0xc9, 0xac, 0x29, 0xd8, 0x18,
  0x04, 0x9d, 0xbe, 0x35, 0xde, 0xcb, 0xd7, 0xd7, 0x01, 0xb9, 0x53, 0x85,
  0xb2, 0x60, 0xec, 0xcc, 0xd6, 0x05, 0xe0, 0xee, 0xb7, 0x08, 0xad, 0x12,
  0xad, 0xbd, 0x2e, 0x87, 0xd9, 0xfb, 0x27, 0x29, 0x00, 0x51, 0x19, 0xf7,
  0x78, 0x98, 0xcd, 0xdc, 0x1b, 0xf5, 0xdc, 0xf6, 0x72, 0x3d, 0x5f, 0x3a,
  0xd2, 0x2d, 0x61, 0x95, 0x40, 0xdd, 0x11, 0x4b, 0x56, 0xac, 0x6c, 0xad,
  0xe5, 0xfa, 0x98, 0x2c, 0x77, 0x11, 0x43, 0xfa, 0x5d, 0xfa, 0xb2, 0x12,
  0x6c, 0xef, 0x05, 0xbe, 0x74, 0xfc, 0x77, 0x55, 0x2f, 0x76, 0xbb, 0x96,
  0xaf, 0x4e, 0x58, 0xd5, 0xbb, 0x39, 0x03, 0xdf, 0xe3, 0x87, 0x82, 0x1a,
  0xef, 0xef, 0xee, 0x3d, 0x62, 0xbc, 0x4b, 0x20, 0x4e, 0xb0, 0x56, 0xc9,
  0xd9, 0xbe, 0xd2, 0x82, 0xe8, 0xa3, 0x6e, 0xde, 0x79, 0xb0, 0xd3, 0x87,
  0xfa, 0xa8, 0xd6, 0x27, 0x25, 0x7a, 0x4c, 0xb2, 0x43
};

static const unsigned char rsa_e[] = {
    0x01, 0x00, 0x01
};

static const unsigned char rsa_d[] = {
  0x52, 0xb6, 0x62, 0xe4, 0xed, 0xa1, 0x48, 0x23, 0x75, 0x58, 0xb3, 0x20,
  0xf0, 0xd2, 0x1b, 0x62, 0x9e, 0xde, 0x9a, 0xb0, 0x54, 0xa4, 0x6f, 0xd0,
  0xfe, 0x72, 0x07, 0x0f, 0x12, 0xe1, 0x76, 0x88, 0x3f, 0xf5, 0xb5, 0x04,
  0x0d, 0xbe, 0xe3, 0x3f, 0x03, 0x4e, 0x98, 0xa9, 0xc1, 0x38, 0x1a, 0x37,
  0x0a, 0xc5, 0xee, 0x1d, 0xde, 0x5c, 0x3d, 0x6f, 0x16, 0x32, 0xe2, 0x78,
  0x12, 0x68, 0x57, 0x18, 0x2f, 0x6b, 0x93, 0x47, 0xa9, 0xd5, 0x71, 0x17,
  0x4d, 0xe2, 0xe5, 0xc0, 0xe7, 0x03, 0xb9, 0xb9, 0x54, 0x48, 0x36, 0xfa,
  0x86, 0xcd, 0xe8, 0x57, 0x81, 0xd9, 0x46, 0x29, 0xb0, 0x93, 0xb7, 0x12,
  0x13, 0x19, 0xce, 0x92, 0x12, 0xab, 0x2f, 0x25, 0xfe, 0x4f, 0xf6, 0xcc,
  0xc2, 0x83, 0xb6, 0xc4, 0x51, 0x4d, 0x80, 0x0c, 0xa4, 0x21, 0xe8, 0xc4,
  0x82, 0x34, 0x89, 0x53, 0xe5, 0xf6, 0x54, 0xbc, 0x02, 0x8c, 0xc3, 0xe0,
  0x75, 0xb4, 0x11, 0xb7, 0x26, 0x43, 0x0b, 0x22, 0xcb, 0xbf, 0xb6, 0x99,
  0x71, 0x9f, 0x8c, 0xee, 0xf0, 0x7b, 0xaa, 0x1b, 0xce, 0x92, 0x1f, 0x79,
  0xf0, 0x77, 0xb8, 0x7b, 0x56, 0x88, 0x4c, 0x60, 0x5d, 0xdb, 0x76, 0xf6,
  0x87, 0xd7, 0x75, 0x0e, 0x17, 0x26, 0x08, 0xfc, 0x4b, 0x04, 0x3e, 0xcf,
  0xe3, 0x13, 0x90, 0xa8, 0x2a, 0x9b, 0x01, 0x13, 0x12, 0x76, 0xe1, 0x94,
  0xa7, 0x22, 0x58, 0x32, 0xd2, 0x91, 0x59, 0x7f, 0x77, 0x82, 0x55, 0xe4,
  0xdc, 0x35, 0x81, 0x8a, 0x60, 0x3d, 0xaf, 0x75, 0xf2, 0x6a, 0xa9, 0xe3,
  0x4f, 0x36, 0xea, 0x0c, 0x2e, 0x4e, 0xf9, 0xd9, 0x09, 0xe2, 0xb7, 0x63,
  0x49, 0x3e, 0x57, 0x5e, 0x4d, 0xdf, 0x6d, 0x76, 0x85, 0x2c, 0xac, 0x3e,
  0xe1, 0x1a, 0x5b, 0x7c, 0x1a, 0x68, 0x15, 0xc4, 0xe0, 0x92, 0x87, 0xe5,
  0xde, 0x49, 0x47, 0xf6, 0xcc, 0xf6, 0x33, 0x2f, 0x62, 0x2a, 0x19, 0x73,
  0x28, 0xc8, 0x10, 0x1b, 0xb5, 0xac, 0xb5, 0x3b, 0xbb, 0x54, 0x4e, 0x0f,
  0x61, 0x4b, 0xed, 0xa6, 0x32, 0x29, 0xa5, 0x88, 0xea, 0x8a, 0xd0, 0x50,
  0x50, 0x03, 0x99, 0x76, 0xdd, 0x49, 0xf3, 0xba, 0x84, 0x9b, 0x89, 0xeb,
  0xf5, 0x0e, 0xc0, 0x3e, 0xea, 0x6b, 0x42, 0xae, 0x22, 0x53, 0x5c, 0x86,
  0x7a, 0xfc, 0x62, 0x66, 0xa0, 0xc0, 0x23, 0x1a, 0xa5, 0x2b, 0x6f, 0x0c,
  0x1c, 0xb3, 0x19, 0xd2, 0x7c, 0x8b, 0x9c, 0x7d, 0x7a, 0x91, 0x6a, 0x92,
  0x26, 0xed, 0xd3, 0x17, 0x8e, 0x90, 0x93, 0x8e, 0xbc, 0x0c, 0x67, 0x40,
  0xc5, 0xa7, 0x6e, 0xdc, 0x04, 0x75, 0x15, 0xa4, 0xa2, 0xc4, 0x23, 0x2d,
  0x42, 0x91, 0x97, 0x31, 0xea, 0x1f, 0x62, 0x81, 0x55, 0x72, 0xcd, 0x8a,
  0xce, 0xb4, 0xda, 0xbf, 0x38, 0x35, 0x9b, 0xa0, 0xea, 0x58, 0x0b, 0x86,
  0x6b, 0xf0, 0x19, 0xff, 0x41, 0x5f, 0x77, 0xd7, 0xe3, 0x76, 0x9a, 0xa0,
  0xdc, 0x89, 0xd0, 0x95, 0x85, 0x87, 0x79, 0xfd, 0x05, 0xe8, 0x2c, 0x88,
  0xb9, 0x60, 0x3c, 0x24, 0x4b, 0x19, 0x18, 0x1e, 0x80, 0x6d, 0xe7, 0x89,
  0x47, 0xd1, 0x1a, 0x98, 0xea, 0x02, 0xe4, 0x1a, 0xd2, 0xd8, 0x60, 0xe3,
  0x68, 0x62, 0x29, 0x4a, 0xaf, 0x08, 0x78, 0x54, 0x0d, 0xaa, 0x94, 0xc9,
  0xd1, 0xad, 0x7d, 0xec, 0xe3, 0x43, 0xf8, 0x9c, 0x41, 0x38, 0x13, 0x94,
  0x7e, 0xf7, 0x53, 0x4f, 0xa8, 0x38, 0x47, 0x52, 0xaa, 0xaf, 0xca, 0x82,
  0x73, 0xec, 0x15, 0xe8, 0xf0, 0x75, 0xbc, 0x0e, 0x64, 0x27, 0xb4, 0x24,
  0x8b, 0x17, 0x3c, 0x75, 0xb6, 0x2d, 0x20, 0x53, 0xe9, 0x25, 0x7e, 0x90,
  0x70, 0x30, 0xe3, 0x8f, 0xa0, 0x8e, 0xa1, 0x90, 0x48, 0x20, 0x11, 0x24,
  0x22, 0xc5, 0xf6, 0x78, 0xb8, 0xe9, 0x5b, 0x99
};

static const unsigned char rsa_p[] = {
  0x00, 0xdb, 0x71, 0x76, 0x0c, 0xa8, 0xb2, 0xef, 0x7c, 0x7d, 0x15, 0x9d,
  0xe1, 0x85, 0x50, 0xdd, 0xcf, 0x9b, 0xda, 0x5d, 0x04, 0x54, 0xfa, 0x4a,
  0x66, 0x47, 0xdc, 0xa4, 0x50, 0x7d, 0x6a, 0xea, 0xd9, 0x18, 0x0c, 0xc0,
  0x58, 0x43, 0xc4, 0x1e, 0x38, 0x85, 0xda, 0xd9, 0xdf, 0x12, 0x06, 0xf4,
  0xd1, 0x33, 0xc6, 0x3a, 0xc4, 0xd4, 0xae, 0xe1, 0x6c, 0x84, 0x59, 0xf8,
  0x04, 0x24, 0x12, 0x3a, 0x20, 0x1d, 0x34, 0x80, 0x37, 0xfb, 0x5c, 0x01,
  0x57, 0xc8, 0xf0, 0x93, 0x45, 0xa3, 0xe4, 0x27, 0x5c, 0xa3, 0xcb, 0x97,
  0xe7, 0x8f, 0x41, 0x24, 0xa3, 0x6c, 0x1d, 0x28, 0x20, 0x8b, 0xe5, 0x32,
  0x6d, 0x08, 0xd7, 0x34, 0x5b, 0x3a, 0xd2, 0xbe, 0x3c, 0xc2, 0xce, 0x69,
  0x9b, 0x08, 0x35, 0x4d, 0x00, 0x56, 0xe4, 0x7e, 0x6c, 0xa7, 0xda, 0xd5,
  0x6d, 0xe9, 0xbf, 0x07, 0xa7, 0xbf, 0x09, 0xdc, 0x0a, 0x53, 0xc4, 0xff,
  0xde, 0xc6, 0xfe, 0xa2, 0x91, 0xc8, 0xdf, 0x11, 0x37, 0x27, 0x46, 0x3a,
  0x3d, 0xec, 0x52, 0x77, 0x70, 0x72, 0xb5, 0xcc, 0xa2, 0xa1, 0xa2, 0x26,
  0x25, 0x79, 0x48, 0x25, 0x4a, 0x70, 0xbd, 0x7e, 0xb4, 0x22, 0x45, 0x30,
  0x40, 0x23, 0x61, 0x1d, 0x44, 0x9d, 0x35, 0x95, 0x82, 0x3a, 0xcf, 0x42,
  0xfc, 0xc4, 0x4c, 0xc0, 0x42, 0x1e, 0x89, 0x9a, 0x21, 0x11, 0x44, 0x06,
  0x75, 0x57, 0x2d, 0x01, 0xd6, 0xa9, 0x15, 0x4c, 0x32, 0x1d, 0x4d, 0xdd,
  0x3d, 0xf4, 0x16, 0xd7, 0xe6, 0x39, 0x0e, 0xac, 0x7e, 0x82, 0x21, 0x51,
  0x67, 0xa1, 0x08, 0xb0, 0x9a, 0xea, 0xb1, 0x04, 0xd3, 0x6c, 0x19, 0xcd,
  0xa4, 0xe0, 0x1e, 0x30, 0xaf, 0xac, 0x23, 0xbc, 0xe0, 0xa1, 0x46, 0x70,
  0xb2, 0xdb, 0x62, 0x8f, 0x26, 0x35, 0x92, 0x07, 0x91, 0xa3, 0x9c, 0x91,
  0x47, 0x95, 0x14, 0x95, 0x6f
};

static const unsigned char rsa_q[] = {
  0x00, 0xfb, 0x6e, 0x82, 0x4a, 0xf3, 0x00, 0xd2, 0x6b, 0xaa, 0x16, 0xa0,
  0xb5, 0x83, 0xe5, 0x1a, 0xe2, 0xf1, 0x51, 0xec, 0x6a, 0x58, 0xc6, 0xc4,
  0x48, 0xe4, 0xe2, 0x92, 0x20, 0x32, 0xec, 0xf8, 0x70, 0x84, 0x02, 0xb4,
  0x9f, 0xe6, 0x47, 0xfa, 0x16, 0x00, 0xe6, 0x4f, 0x7e, 0x59, 0x2d, 0xc0,
  0x53, 0x5d, 0xbf, 0xa9, 0x87, 0xee, 0x70, 0x48, 0xf0, 0x9f, 0x16, 0xac,
  0xdd, 0xbb, 0x5c, 0xbd, 0x8f, 0x51, 0x57, 0xbc, 0xd3, 0xcf, 0x9c, 0x6e,
  0xc9, 0xf4, 0x00, 0x7d, 0x55, 0xa6, 0x09, 0xea, 0xdb, 0x90, 0x68, 0x7e,
  0x1c, 0xa0, 0xff, 0x89, 0x18, 0xb6, 0xab, 0x07, 0xef, 0xca, 0x7b, 0x24,
  0x8a, 0x5b, 0x6d, 0x96, 0xb3, 0xf5, 0x67, 0xcd, 0x88, 0xdd, 0xdb, 0x3a,
  0xe6, 0xec, 0x83, 0x71, 0xf7, 0x25, 0x83, 0x89, 0xb1, 0x6b, 0x32, 0x83,
  0x26, 0x47, 0x45, 0x7e, 0xec, 0xdf, 0xe3, 0xb8, 0xf4, 0x7b, 0x84, 0x67,
  0x23, 0x6a, 0x83, 0xac, 0x29, 0xe0, 0x9c, 0xb3, 0x2f, 0xbd, 0x55, 0x60,
  0x98, 0x04, 0x6a, 0x6d, 0xbe, 0x58, 0xec, 0x5e, 0x30, 0x18, 0xe7, 0x01,
  0x85, 0xdb, 0x50, 0xe8, 0xf1, 0xef, 0x2d, 0x50, 0xa4, 0x4e, 0x33, 0xe1,
  0x49, 0x1a, 0x50, 0xca, 0xc2, 0x17, 0x0e, 0x51, 0xb2, 0xaa, 0x90, 0x1b,
  0x11, 0xc7, 0xf0, 0x44, 0x3b, 0x81, 0xeb, 0xb9, 0x6e, 0x44, 0x61, 0xf1,
  0xc4, 0x46, 0xf8, 0xda, 0x94, 0xc1, 0x95, 0x3b, 0xed, 0xa9, 0x13, 0xc7,
  0x5f, 0x33, 0xb2, 0x85, 0xd3, 0x91, 0x22, 0x79, 0x88, 0x41, 0xe2, 0xa1,
  0x36, 0x82, 0x87, 0x37, 0x2e, 0x4f, 0x22, 0x1f, 0xee, 0x5f, 0x93, 0x80,
  0x89, 0x67, 0x56, 0x82, 0x99, 0x40, 0x22, 0xf8, 0xb7, 0xf1, 0xe0, 0xc2,
  0x4b, 0x12, 0xde, 0x26, 0x27, 0xa5, 0x4f, 0x5a, 0x13, 0x6b, 0x7f, 0x6a,
  0xf2, 0x78, 0xf3, 0x0e, 0x6d
};

static const unsigned char rsa_dp[] = {
  0x00, 0xcb, 0xf9, 0x41, 0xe6, 0x70, 0x64, 0xaa, 0x90, 0xc7, 0x5f, 0xf1,
  0x79, 0xef, 0xc6, 0x83, 0xf6, 0xf7, 0x02, 0x59, 0x15, 0xae, 0xbb, 0x5b,
  0xae, 0x88, 0xbb, 0x81, 0x8c, 0x43, 0x97, 0xbf, 0x25, 0xfd, 0xe1, 0xd4,
  0x63, 0xf6, 0xd1, 0x73, 0xd9, 0xcc, 0x29, 0xe9, 0xfc, 0x1c, 0x30, 0x95,
  0x1d, 0x64, 0x07, 0xad, 0x16, 0xca, 0x2e, 0xa7, 0xe0, 0x8b, 0x81, 0x69,
  0x34, 0xc8, 0x26, 0x9d, 0x1a, 0xbe, 0xaa, 0xcf, 0x47, 0xba, 0x00, 0x02,
  0x4b, 0x8b, 0xbe, 0x7a, 0xd5, 0xef, 0x8a, 0x22, 0x40, 0x4d, 0x0b, 0xf0,
  0x6d, 0xcf, 0xcd, 0x98, 0x75, 0xc3, 0x07, 0xb3, 0x05, 0xd5, 0xa3, 0x3c,
  0x64, 0xf7, 0x23, 0xba, 0x49, 0xd6, 0x7a, 0x8f, 0x53, 0xc1, 0x2b, 0xc6,
  0x23, 0xd1, 0xd4, 0x61, 0x77, 0xa0, 0x4d, 0x11, 0x6a, 0x83, 0xf7, 0xb8,
  0x0d, 0x4b, 0x89, 0x42, 0x5f, 0x5d, 0x06, 0x98, 0x1e, 0x8d, 0x50, 0xff,
  0x19, 0x1f, 0x55, 0x0e, 0xdd, 0x7d, 0x9e, 0x42, 0xcd, 0x46, 0x57, 0x53,
  0xc9, 0xbd, 0x41, 0xc6, 0x3d, 0xa2, 0x92, 0x73, 0xdc, 0xf3, 0x6a, 0xda,
  0x14, 0x59, 0x10, 0x83, 0x81, 0x17, 0x1c, 0x3c, 0x8a, 0xc9, 0x94, 0x10,
  0x4e, 0x7d, 0xd4, 0x46, 0x35, 0x41, 0xff, 0xcd, 0xb1, 0xd8, 0x62, 0x50,
  0xfc, 0xcc, 0xa6, 0x1e, 0xcb, 0x16, 0xc1, 0x86, 0x9f, 0x98, 0x01, 0xe8,
  0x12, 0xe7, 0xee, 0x30, 0xd8, 0x4c, 0x20, 0x3c, 0xcc, 0x14, 0x4b, 0x0d,
  0x0c, 0x0a, 0x37, 0xb5, 0x85, 0x0c, 0xa2, 0x24, 0x1a, 0x0f, 0x71, 0x52,
  0xce, 0x85, 0x73, 0xa3, 0x5c, 0xcc, 0x2b, 0xb0, 0xb5, 0xa8, 0xb4, 0xaf,
  0x5e, 0xc2, 0xe7, 0xad, 0x0f, 0x8d, 0x6d, 0x46, 0xa2, 0x71, 0xa6, 0x1d,
  0x19, 0x53, 0x2c, 0xe0, 0xac, 0x7e, 0x7c, 0xf7, 0x46, 0x1b, 0x93, 0x6b,
  0xc2, 0xe2, 0xc2, 0xd8, 0x47
};

static const unsigned char rsa_dq[] = {
  0x00, 0xbb, 0x12, 0x20, 0xdd, 0x14, 0xea, 0x62, 0xa4, 0xfa, 0x7b, 0x35,
  0x7d, 0x78, 0x31, 0xe9, 0x0c, 0x3b, 0x52, 0xa1, 0xdd, 0x0a, 0x4a, 0x71,
  0x56, 0x6e, 0xfd, 0xe8, 0x8d, 0x0e, 0x76, 0xe3, 0xee, 0x0b, 0x3a, 0x5c,
  0x1b, 0xb0, 0x61, 0x93, 0x3f, 0xf5, 0xd1, 0x66, 0x09, 0xf2, 0xde, 0x28,
  0x7f, 0x9e, 0x7b, 0xf0, 0xee, 0x13, 0x48, 0xf5, 0xec, 0x19, 0xe1, 0xec,
  0x22, 0x59, 0xba, 0x09, 0xcb, 0xed, 0x50, 0xa3, 0x4c, 0xd0, 0xe6, 0x6a,
  0x43, 0xd6, 0x48, 0xda, 0xf7, 0xf3, 0xbe, 0xe3, 0x40, 0x13, 0xb4, 0xbb,
  0x48, 0x1f, 0xbd, 0xa0, 0xca, 0x83, 0x76, 0xc3, 0x43, 0xf5, 0x5a, 0x23,
  0xf8, 0xd1, 0x47, 0xbb, 0x5e, 0x0f, 0xd3, 0xf8, 0xc7, 0xc1, 0x91, 0xd0,
  0xc4, 0x69, 0xea, 0xee, 0xcb, 0x5c, 0xdc, 0xfe, 0x80, 0xc3, 0xea, 0x64,
  0x4c, 0x01, 0xb1, 0x42, 0x5b, 0x89, 0xc5, 0x4c, 0x22, 0x93, 0x18, 0x13,
  0x08, 0xf5, 0xc2, 0x1c, 0x41, 0x58, 0x3e, 0x1e, 0xd0, 0x01, 0x45, 0xd9,
  0xc5, 0xa1, 0x5b, 0x72, 0x65, 0xb2, 0x91, 0xc3, 0x0e, 0x74, 0x28, 0xc4,
  0x28, 0x4c, 0xe2, 0x69, 0x3f, 0x40, 0x9e, 0x6d, 0xa6, 0xa2, 0x0c, 0xd5,
  0xac, 0xe7, 0x68, 0x7f, 0x43, 0x63, 0x96, 0x22, 0xd1, 0x15, 0x38, 0x7c,
  0xfb, 0x80, 0xd0, 0x52, 0x64, 0x18, 0x29, 0x43, 0xe1, 0x37, 0xfd, 0xcb,
  0xbd, 0x26, 0xb5, 0x17, 0x24, 0xa0, 0xd7, 0xa1, 0x2c, 0x15, 0xa5, 0x82,
  0xac, 0x61, 0xb1, 0x8d, 0x02, 0xb9, 0xb4, 0x75, 0xca, 0x1c, 0x83, 0x3b,
  0x41, 0x6c, 0x62, 0xa0, 0x7a, 0xd3, 0x23, 0xe7, 0xb0, 0x1a, 0xea, 0x8b,
  0x33, 0x30, 0x70, 0xdc, 0x60, 0x9b, 0xa8, 0xa9, 0x77, 0x6a, 0xfe, 0xb8,
  0x70, 0xd5, 0x0b, 0xf6, 0x45, 0x7f, 0x28, 0x88, 0x33, 0x74, 0xc2, 0xeb,
  0xd6, 0x96, 0x88, 0xf9, 0x0d
};

static const unsigned char rsa_qp[] = {
  0x00, 0xb3, 0x5c, 0xa4, 0xd3, 0x79, 0x8e, 0x50, 0xb3, 0x61, 0xdf, 0xb5,
  0x15, 0xdb, 0xc8, 0xb4, 0x5d, 0xb1, 0x7b, 0xd3, 0x4f, 0xeb, 0x03, 0xeb,
  0x0f, 0x09, 0xe1, 0x97, 0x98, 0x1f, 0x59, 0xab, 0x47, 0x75, 0x24, 0x78,
  0xf2, 0x63, 0xd7, 0x6e, 0x50, 0x21, 0x01, 0x2d, 0x7e, 0xdd, 0x5a, 0x00,
  0xa5, 0xd0, 0x08, 0xad, 0x25, 0xd9, 0x9a, 0x40, 0xb9, 0x4a, 0xe8, 0x2c,
  0x42, 0x27, 0x94, 0xba, 0x9f, 0x78, 0xb7, 0x96, 0xd1, 0x61, 0xa3, 0x63,
  0xc4, 0x1a, 0x28, 0xd7, 0x14, 0x75, 0x80, 0x67, 0xa6, 0xed, 0x2c, 0x72,
  0x7b, 0xc4, 0x41, 0xb5, 0xad, 0x8a, 0x7f, 0x39, 0x0f, 0xba, 0xbb, 0x51,
  0x81, 0x81, 0xf1, 0x45, 0xf2, 0xc7, 0x22, 0x2f, 0x17, 0xee, 0x48, 0x71,
  0x2a, 0x6a, 0xee, 0x73, 0x9e, 0xc1, 0xaf, 0x34, 0x5b, 0x65, 0xd1, 0xaf,
  0x95, 0xf6, 0xcc, 0xfe, 0xf3, 0x12, 0xaf, 0xd8, 0x5a, 0x6f, 0xa8, 0x23,
  0x30, 0x8a, 0xab, 0xce, 0x3e, 0x84, 0x08, 0x2d, 0xd0, 0xbf, 0x16, 0x96,
  0xae, 0x49, 0x91, 0x6c, 0xdb, 0x71, 0x40, 0xe1, 0x2a, 0xd3, 0x63, 0xe6,
  0xaa, 0xda, 0x59, 0xb1, 0x88, 0x88, 0xc2, 0xde, 0xaf, 0x86, 0xef, 0xd0,
  0x24, 0x59, 0xf6, 0x31, 0x3a, 0x9b, 0xf5, 0x4c, 0x55, 0x88, 0xe2, 0xd0,
  0xbf, 0x40, 0x51, 0x59, 0x8c, 0x2e, 0x20, 0xdb, 0x91, 0x7d, 0x11, 0x06,
  0xfc, 0x3b, 0x21, 0x48, 0xf6, 0x00, 0xff, 0x1a, 0x97, 0x12, 0xc1, 0x7f,
  0xdd, 0x77, 0x18, 0xf7, 0x01, 0xed, 0x14, 0x04, 0xaa, 0xca, 0xe6, 0xa1,
  0x43, 0x2e, 0x5c, 0xa4, 0x53, 0x58, 0xc1, 0x55, 0xc7, 0x00, 0x36, 0x6e,
  0x25, 0xfe, 0x20, 0x6b, 0x22, 0xcd, 0x7e, 0x9a, 0xdf, 0x82, 0x1c, 0x99,
  0x78, 0x6c, 0x4e, 0x97, 0xd2, 0x2c, 0x6e, 0xaf, 0xe0, 0x0c, 0x08, 0x6d,
  0x90, 0x64, 0x39, 0x73, 0x03
};
#else
static const unsigned char rsa_n[] = {
  0x00, 0xa3, 0x85, 0xa3, 0x59, 0x7d, 0x1e, 0x5f, 0x25, 0xf9, 0x1b, 0x95,
  0x6b, 0x35, 0x95, 0x0e, 0x36, 0xbf, 0xc5, 0x3f, 0xe1, 0x6e, 0x0a, 0x09,
  0xfd, 0xf7, 0x99, 0xe8, 0xd6, 0x31, 0x71, 0x01, 0x01, 0x1a, 0x16, 0x15,
  0x58, 0x21, 0x0b, 0xcc, 0xaa, 0xa0, 0xb2, 0x1f, 0x8e, 0xed, 0x74, 0xcc,
  0x97, 0x66, 0x22, 0xce, 0x13, 0x3a, 0xe6, 0xa1, 0x26, 0x5f, 0xf5, 0xf1,
  0xde, 0x7d, 0xd1, 0xc9, 0x31, 0xc6, 0x3d, 0x81, 0x0e, 0xe2, 0xdb, 0xf7,
  0x61, 0xd1, 0x5d, 0x26, 0x10, 0x56, 0xb9, 0x72, 0x1c, 0x2c, 0x0a, 0xb8,
  0x0f, 0x6c, 0xab, 0x19, 0x94, 0x28, 0x40, 0x69, 0x3b, 0xdb, 0x42, 0x3c,
  0x84, 0x39, 0x18, 0xe3, 0x87, 0xa4, 0xce, 0x84, 0xcc, 0x3c, 0xab, 0x75,
  0x54, 0x18, 0x62, 0x2d, 0x05, 0x88, 0x7d, 0xa2, 0x9a, 0x34, 0xbc, 0x8e,
  0xfa, 0x9d, 0x89, 0xb2, 0x1a, 0x7d, 0x60, 0xcc, 0xcd, 0x68, 0xe5, 0x79,
  0x04, 0x58, 0x98, 0x10, 0xcd, 0x88, 0xee, 0x7f, 0x7d, 0x6e, 0xc3, 0x32,
  0x3d, 0x8f, 0x47, 0x20, 0x43, 0x53, 0x3c, 0x06, 0xf7, 0x21, 0xd2, 0x19,
  0x3a, 0x78, 0xcd, 0x9e, 0xdb, 0x06, 0x94, 0xaf, 0xc7, 0x8c, 0xe1, 0x23,
  0xf0, 0x33, 0x5d, 0x50, 0x4c, 0x58, 0x42, 0xe7, 0xca, 0x36, 0x23, 0x07,
  0x4a, 0xd2, 0x20, 0x91, 0x03, 0x48, 0x87, 0x20, 0xfc, 0xf7, 0x97, 0xc7,
  0xca, 0x8a, 0x42, 0x17, 0x0a, 0x41, 0x72, 0x24, 0x40, 0x38, 0x9d, 0x05,
  0x4c, 0x3a, 0x21, 0x90, 0x68, 0xda, 0xc1, 0x22, 0x3a, 0x88, 0x7c, 0x2f,
  0x8a, 0x55, 0x97, 0xca, 0xf6, 0xca, 0xf6, 0xe4, 0x2a, 0x51, 0xc3, 0xec,
  0xcf, 0x97, 0x31, 0x70, 0x1e, 0x4c, 0x0a, 0x9a, 0x9d, 0x2e, 0x2c, 0x3f,
  0xf9, 0xbe, 0x58, 0x20, 0x11, 0x21, 0xe1, 0x3d, 0x62, 0x39, 0xb5, 0x03,
  0x46, 0xe7, 0x69, 0x62, 0x31, 0xd2, 0xcc, 0x6f, 0xee, 0xf3, 0x5d, 0xe5,
  0x21, 0xb7, 0x8b, 0x3a, 0x7b, 0x31, 0x7b, 0xa8, 0x54, 0xa3, 0xf8, 0x63,
  0xf0, 0x43, 0xa1, 0xc4, 0x69, 0x47, 0x66, 0xfb, 0x68, 0xa4, 0x8f, 0x9e,
  0xba, 0xe4, 0xa7, 0xf1, 0x9c, 0x17, 0x25, 0xcf, 0xb6, 0xc1, 0x78, 0x41,
  0x88, 0x13, 0x4f, 0xff, 0x56, 0x4b, 0x90, 0x9d, 0x01, 0x36, 0x35, 0x62,
  0xf7, 0xb3, 0x32, 0xb1, 0x80, 0x62, 0x71, 0x1f, 0x68, 0x58, 0x02, 0x03,
  0xb6, 0x50, 0x32, 0xf5, 0xe5, 0x2d, 0xfb, 0x10, 0x4d, 0xbb, 0x04, 0x80,
  0xfa, 0x84, 0x20, 0x69, 0x03, 0xaa, 0x4d, 0xb3, 0xb3, 0xd6, 0x5d, 0xfb,
  0x7b, 0x9a, 0x7e, 0xf8, 0xc5, 0x8a, 0x00, 0x2d, 0x10, 0xea, 0xa2, 0xb7,
  0x16, 0x51, 0x2b, 0xc5, 0x8a, 0x19, 0xf1, 0x84, 0x18, 0x26, 0xd7, 0x04,
  0x7c, 0x65, 0xbc, 0xeb, 0xa5, 0xe3, 0x59, 0x10, 0xb6, 0x0b, 0x23, 0x78,
  0x25
};

static const unsigned char rsa_e[] = {
    0x01, 0x00, 0x01
};

static const unsigned char rsa_d[] = {
  0x04, 0x28, 0xd3, 0xa9, 0x1a, 0x8e, 0x9b, 0x53, 0x84, 0xb0, 0x3b, 0x40,
  0x09, 0x19, 0x6a, 0x10, 0xb9, 0x67, 0x70, 0x70, 0x3b, 0x04, 0x71, 0x17,
  0xc8, 0x9d, 0xf1, 0xf2, 0x2a, 0x20, 0x6d, 0x02, 0x6e, 0x0f, 0x8c, 0x0f,
  0x71, 0xef, 0x53, 0xd9, 0x8c, 0xf2, 0xfe, 0x58, 0x32, 0x2d, 0xae, 0x17,
  0xdd, 0xe9, 0x21, 0x28, 0x65, 0x1e, 0xa3, 0x09, 0xb4, 0xdb, 0x2e, 0xb7,
  0xbe, 0xdd, 0xe5, 0xaa, 0x0e, 0x25, 0x9b, 0x6a, 0x7e, 0x78, 0x0f, 0x32,
  0xc4, 0xd6, 0x2b, 0xf3, 0x7c, 0x8d, 0x0b, 0xb0, 0x73, 0x8d, 0xec, 0xc5,
  0xec, 0xb8, 0xfa, 0x85, 0x0f, 0xd9, 0x0d, 0xb2, 0x89, 0x73, 0xae, 0x30,
  0xb6, 0xd6, 0x0b, 0xc3, 0x9c, 0x7c, 0x3a, 0xaa, 0x39, 0x6a, 0x89, 0x6c,
  0x56, 0xef, 0x7f, 0x1d, 0x78, 0x63, 0xdf, 0xa1, 0x9c, 0xc1, 0xcd, 0xdb,
  0xca, 0x57, 0x23, 0x0f, 0x80, 0x62, 0xd8, 0x99, 0x8c, 0x61, 0xa2, 0x59,
  0x42, 0xe6, 0x64, 0x9a, 0x64, 0xfb, 0x81, 0x26, 0xb3, 0x57, 0x50, 0x2e,
  0xe6, 0xcb, 0x45, 0x52, 0x16, 0x25, 0xee, 0x1c, 0xe6, 0xc5, 0x8c, 0x01,
  0x79, 0xb4, 0xc3, 0xce, 0x37, 0x86, 0xa3, 0x06, 0xa8, 0x53, 0x43, 0xe0,
  0x8d, 0x3d, 0x16, 0x84, 0xa6, 0x6c, 0x34, 0xd6, 0xe0, 0x43, 0x21, 0xf2,
  0x24, 0xc1, 0x58, 0xc9, 0xe9, 0xbf, 0xf6, 0x32, 0xf5, 0xbc, 0x4b, 0x2c,
  0x5f, 0xeb, 0x6d, 0x43, 0x21, 0x49, 0xee, 0x64, 0x8e, 0x46, 0x31, 0x75,
  0x0e, 0x0c, 0xf8, 0x11, 0x87, 0x6f, 0x41, 0xf5, 0xde, 0x11, 0x29, 0x30,
  0xf1, 0x26, 0x74, 0x6e, 0xa7, 0x70, 0xe0, 0xe6, 0xfe, 0x54, 0x14, 0x54,
  0x27, 0x44, 0x9b, 0x27, 0xac, 0x79, 0x69, 0xa9, 0xb4, 0x14, 0x33, 0x26,
  0x91, 0x2d, 0x6f, 0x5f, 0xe7, 0xf3, 0x60, 0xcd, 0x9a, 0xbc, 0xe4, 0x25,
  0x2f, 0xe1, 0xf0, 0x7b, 0x16, 0x60, 0x9c, 0xa7, 0x04, 0xa1, 0x79, 0x01,
  0xf2, 0x47, 0x58, 0x16, 0x5e, 0x2e, 0x15, 0xf9, 0xa4, 0xf0, 0x15, 0x74,
  0x54, 0xe1, 0x4e, 0x58, 0xbd, 0x75, 0xcd, 0x27, 0x0c, 0x82, 0x60, 0xa0,
  0xcb, 0x01, 0x63, 0x4b, 0x00, 0x4b, 0x10, 0xcb, 0x65, 0x6d, 0x99, 0xba,
  0x0c, 0xfe, 0x9d, 0xa4, 0x7a, 0xc6, 0xb4, 0x66, 0xb2, 0x0c, 0x0d, 0xa1,
  0x4d, 0xad, 0xc1, 0x55, 0x31, 0xbb, 0x63, 0xbb, 0xee, 0x03, 0x4f, 0xe7,
  0x07, 0x7f, 0x42, 0x9d, 0xa4, 0xe8, 0xdc, 0xf1, 0x36, 0x76, 0x8e, 0xbc,
  0x68, 0x67, 0xaa, 0x36, 0x8d, 0x53, 0x4d, 0x83, 0xc6, 0x08, 0x1b, 0x19,
  0x56, 0xd5, 0x9f, 0xa5, 0x55, 0xfd, 0xad, 0x6f, 0x82, 0x0e, 0x49, 0x8f,
  0xa0, 0xf2, 0x36, 0xa4, 0x31, 0x51, 0xb0, 0xd8, 0x74, 0x88, 0x1f, 0x03,
  0x7c, 0xe4, 0x05, 0xaa, 0xeb, 0x65, 0x3f, 0x2d, 0x7d, 0xbe, 0x84, 0x29
};

static const unsigned char rsa_p[] = {
  0x00, 0xe2, 0xcc, 0x3b, 0xe2, 0x84, 0xd9, 0xf5, 0x2d, 0x99, 0x09, 0x13,
  0xd9, 0x61, 0xef, 0x41, 0x8c, 0x53, 0xaf, 0x55, 0x4c, 0x6d, 0x6c, 0x11,
  0x8b, 0x72, 0x80, 0x2b, 0x82, 0x35, 0x22, 0x75, 0x36, 0xa5, 0x7e, 0x7a,
  0xa6, 0xfc, 0x9a, 0x8e, 0xab, 0x5a, 0x34, 0x5b, 0xd1, 0x3b, 0x5d, 0xc5,
  0x2a, 0x55, 0x6d, 0x0b, 0x89, 0xc4, 0x3e, 0x6e, 0xf8, 0x68, 0xc7, 0x0e,
  0x33, 0x74, 0x33, 0xdd, 0x2d, 0x3c, 0xec, 0x14, 0x24, 0x83, 0x43, 0xc3,
  0xd9, 0x5c, 0x27, 0x58, 0x19, 0xb7, 0x71, 0xa1, 0x19, 0x18, 0x48, 0xa5,
  0x43, 0x52, 0x86, 0x3a, 0x76, 0x2d, 0x89, 0x52, 0x1c, 0x1a, 0xcf, 0xbe,
  0x01, 0x96, 0x37, 0xdf, 0xec, 0x00, 0xf4, 0xfd, 0x41, 0xd8, 0x4b, 0x70,
  0x4c, 0x8f, 0xb3, 0x7d, 0xe0, 0x5d, 0x43, 0xdb, 0x92, 0xb2, 0x04, 0x6e,
  0x7f, 0xeb, 0xdb, 0xd5, 0x3b, 0x3a, 0x34, 0x4e, 0x18, 0x62, 0x73, 0xe8,
  0xf2, 0xc3, 0x74, 0x69, 0xe1, 0xe9, 0xa3, 0x55, 0x82, 0x82, 0x82, 0xee,
  0xfb, 0x0d, 0x74, 0xee, 0x7a, 0x5c, 0x62, 0x29, 0xfa, 0xb5, 0x51, 0x51,
  0xe6, 0x27, 0x7a, 0xa3, 0x3e, 0xa1, 0x49, 0x81, 0x7a, 0xcb, 0xe0, 0x4c,
  0x60, 0xcb, 0xf4, 0x75, 0xff, 0xc2, 0x77, 0x26, 0x45, 0xd0, 0xb7, 0xd3,
  0xa8, 0xa7, 0x5d, 0x27, 0x4b, 0x68, 0x63, 0x42, 0x3a, 0xe9, 0xa1, 0x5d,
  0xb3
};

static const unsigned char rsa_q[] = {
  0x00, 0xb8, 0x93, 0xb1, 0x40, 0x6e, 0xba, 0x57, 0x1a, 0x3f, 0x65, 0x6e,
  0x1c, 0xe8, 0x67, 0xf0, 0xb9, 0x02, 0x61, 0xd8, 0x0a, 0x4f, 0x11, 0x86,
  0x35, 0xae, 0x70, 0x87, 0x2e, 0xff, 0xe8, 0xd8, 0x5d, 0x7d, 0xec, 0x8d,
  0x6c, 0xcc, 0xc6, 0xf8, 0x64, 0x67, 0xa7, 0xf1, 0xdb, 0xf5, 0x74, 0xcd,
  0xa2, 0x25, 0x97, 0x91, 0xcb, 0x05, 0x84, 0xe2, 0x04, 0x04, 0x4e, 0x3a,
  0x54, 0x61, 0x17, 0xe1, 0xe7, 0x74, 0x48, 0xac, 0x37, 0xe6, 0xea, 0xfc,
  0x14, 0x76, 0xfe, 0xc8, 0x5e, 0x16, 0xed, 0xb3, 0x37, 0xbc, 0x6e, 0xb3,
  0xdc, 0xbc, 0xe7, 0x1f, 0x56, 0x23, 0xac, 0xed, 0x7f, 0x1a, 0xc9, 0x49,
  0xf0, 0x14, 0x82, 0x14, 0x47, 0x73, 0x9c, 0xbf, 0x8d, 0xcd, 0x76, 0x13,
  0x7a, 0xfa, 0xa0, 0x62, 0x66, 0xd9, 0x7d, 0xe8, 0xcd, 0xd1, 0xb2, 0xf3,
  0xce, 0x93, 0x73, 0x23, 0x86, 0x12, 0x99, 0xb3, 0x76, 0xb6, 0x63, 0x05,
  0xc3, 0x13, 0x83, 0x66, 0x31, 0xaa, 0xf5, 0x80, 0xe5, 0x7f, 0xb2, 0xc4,
  0xee, 0x16, 0xd1, 0x7b, 0xe0, 0x84, 0xde, 0xb4, 0x1a, 0x72, 0x09, 0x6f,
  0x06, 0x07, 0xc3, 0x0d, 0x51, 0x48, 0x2c, 0x08, 0x76, 0xe3, 0x24, 0xa8,
  0xf0, 0x96, 0xcb, 0x8e, 0x3e, 0xd7, 0xb2, 0xac, 0xd4, 0x0c, 0x6b, 0x5d,
  0x25, 0x63, 0xd4, 0x85, 0x01, 0x44, 0x0e, 0x39, 0x64, 0xdc, 0x20, 0xd6,
  0xc7
};

static const unsigned char rsa_dp[] = {
  0x04, 0xa9, 0x53, 0xf5, 0xc4, 0xeb, 0x41, 0xe9, 0xcd, 0x02, 0x6d, 0xc1,
  0x03, 0x0d, 0x4a, 0xd8, 0x9a, 0x83, 0xb9, 0x0a, 0x18, 0x19, 0xa7, 0x86,
  0xa9, 0x34, 0xcf, 0x30, 0x1e, 0xed, 0x75, 0x61, 0x49, 0x27, 0x7f, 0x57,
  0xdd, 0x4b, 0x43, 0xf1, 0x6b, 0xaa, 0x35, 0xd4, 0xe8, 0x16, 0x76, 0x4d,
  0xf7, 0x71, 0x85, 0x52, 0x30, 0x91, 0x63, 0xf0, 0x81, 0x1e, 0xce, 0x40,
  0xea, 0x7b, 0x82, 0x69, 0x42, 0x9e, 0x4b, 0x8f, 0xb0, 0x8e, 0xfd, 0x00,
  0x83, 0xaf, 0x5f, 0x55, 0x2f, 0xfb, 0x0a, 0xe7, 0x9c, 0x23, 0x2a, 0x1a,
  0x67, 0x20, 0xd1, 0x24, 0xca, 0xac, 0xce, 0xde, 0x3b, 0x02, 0xd8, 0x11,
  0xea, 0x47, 0x7d, 0xb7, 0xb9, 0x11, 0x4f, 0xff, 0x41, 0x75, 0xd3, 0x7a,
  0x0f, 0x5e, 0x0e, 0x11, 0x45, 0x79, 0x76, 0x92, 0xde, 0x4b, 0xcf, 0x05,
  0x9c, 0x10, 0x69, 0xa2, 0x8d, 0x00, 0xb4, 0x36, 0x36, 0x17, 0xd1, 0xca,
  0xe3, 0x8f, 0x89, 0xf9, 0x95, 0xb6, 0xc0, 0xb4, 0x2d, 0x00, 0x89, 0xee,
  0xe9, 0x08, 0xe5, 0x39, 0xe8, 0x9a, 0x2f, 0xe8, 0xb2, 0x3f, 0x58, 0xa2,
  0x95, 0x5f, 0x24, 0xe9, 0xcd, 0xa0, 0xd8, 0x23, 0x70, 0xfb, 0x4c, 0x36,
  0x95, 0x1a, 0x92, 0x2e, 0x4e, 0x8d, 0xea, 0x60, 0x76, 0xf8, 0xc0, 0x45,
  0xf0, 0x22, 0xaf, 0x03, 0x12, 0xc3, 0x2f, 0x82, 0x4c, 0x78, 0xff, 0x97
};

static const unsigned char rsa_dq[] = {
  0x4c, 0xd9, 0x01, 0x15, 0x88, 0x84, 0x80, 0xbb, 0x66, 0xe5, 0xbe, 0x20,
  0xbf, 0x0a, 0x77, 0x89, 0x2f, 0xda, 0xb8, 0xee, 0x21, 0xd9, 0x73, 0xfd,
  0x69, 0xb1, 0x64, 0x37, 0x47, 0x49, 0x14, 0xbc, 0x68, 0x2f, 0x52, 0xfa,
  0x97, 0x8f, 0xc7, 0xdf, 0x55, 0xe0, 0xf0, 0xab, 0xd9, 0xd8, 0x55, 0xbd,
  0x4a, 0xd5, 0x7e, 0x57, 0xfe, 0xe6, 0x42, 0x8b, 0xd5, 0x97, 0x14, 0x66,
  0x09, 0x3e, 0xbe, 0x49, 0x75, 0x7a, 0xc4, 0x69, 0x49, 0xf5, 0x50, 0x1a,
  0xdd, 0x28, 0x5b, 0x18, 0x01, 0x87, 0xd9, 0xf4, 0x3c, 0xba, 0x02, 0x9c,
  0xc6, 0xf1, 0x9b, 0x74, 0x6b, 0xca, 0x15, 0xdf, 0xb3, 0xb1, 0x56, 0xdd,
  0x64, 0x4c, 0x7c, 0x50, 0xfb, 0x6b, 0xa9, 0xbd, 0x4a, 0x6b, 0xfc, 0xd4,
  0x59, 0x00, 0xe9, 0xb7, 0x54, 0x9a, 0x3d, 0x91, 0x63, 0xdb, 0x93, 0xf2,
  0xd0, 0x25, 0x42, 0x07, 0x12, 0x3b, 0x78, 0x22, 0xd6, 0xf1, 0x07, 0x77,
  0x1e, 0xea, 0xb8, 0x63, 0xb9, 0x80, 0x19, 0xb8, 0x73, 0xa0, 0x64, 0xa9,
  0x94, 0x4a, 0x87, 0xbf, 0x04, 0xd3, 0x0c, 0x3d, 0x6e, 0x79, 0x4b, 0x06,
  0x41, 0xb9, 0x0e, 0x14, 0x67, 0x6e, 0x1d, 0xe0, 0x11, 0xd6, 0x33, 0x98,
  0x67, 0xd0, 0x3c, 0x5b, 0x21, 0xc7, 0x3c, 0x79, 0xd4, 0xe9, 0xe6, 0x90,
  0x28, 0xae, 0x54, 0xea, 0x20, 0x01, 0xa4, 0x17, 0xc0, 0x26, 0xd4, 0x05
};

static const unsigned char rsa_qp[] = {
  0x00, 0xd9, 0xa6, 0x79, 0xa1, 0x55, 0x81, 0xfb, 0xd1, 0x5b, 0xf3, 0x83,
  0x58, 0x10, 0xbe, 0x33, 0x14, 0x43, 0xf8, 0x99, 0xa9, 0x58, 0xd2, 0xa7,
  0x3d, 0xb4, 0x99, 0x98, 0xf2, 0x3c, 0xca, 0xf7, 0xb3, 0x14, 0x86, 0x2b,
  0xe2, 0x32, 0x29, 0xb8, 0x14, 0x2d, 0x28, 0xfb, 0x06, 0x94, 0xc4, 0x04,
  0x39, 0x26, 0x29, 0x50, 0xb8, 0x61, 0xc0, 0xa9, 0xb0, 0x46, 0x4e, 0x1a,
  0xa7, 0x43, 0x75, 0xd6, 0x63, 0xc7, 0x6a, 0x22, 0xe3, 0xe6, 0x38, 0x97,
  0xf3, 0x01, 0x59, 0x40, 0x87, 0xbc, 0xa0, 0x6a, 0x9a, 0x85, 0xcb, 0x08,
  0xdd, 0x33, 0xa5, 0xa8, 0x6f, 0xd8, 0xfb, 0x0a, 0x82, 0x1f, 0xb1, 0x79,
  0xb0, 0x27, 0xae, 0xaf, 0x3f, 0xb7, 0x65, 0x99, 0x91, 0xd0, 0xfe, 0x41,
  0xe3, 0x36, 0x5f, 0xd5, 0x25, 0xa8, 0x16, 0x1b, 0xf4, 0x99, 0xca, 0x66,
  0xce, 0xc7, 0x49, 0x55, 0x1e, 0x01, 0x17, 0xa6, 0x0d, 0x03, 0x70, 0x2e,
  0x2f, 0x6d, 0x61, 0x1c, 0xbd, 0xaa, 0x60, 0xab, 0xeb, 0xd9, 0xef, 0xde,
  0xb6, 0x79, 0x1e, 0x8e, 0x80, 0x8e, 0x95, 0x36, 0x08, 0x00, 0x69, 0xb1,
  0x64, 0x4b, 0x37, 0x87, 0x1d, 0x52, 0x88, 0xae, 0x2c, 0xfc, 0x5c, 0x62,
  0x97, 0x92, 0x6c, 0xdf, 0xb8, 0x23, 0x0b, 0xb9, 0x09, 0x3f, 0xb4, 0x90,
  0xb2, 0x05, 0x8b, 0xd9, 0x8c, 0xd0, 0xa2, 0x39, 0x13, 0xf9, 0x95, 0xdd,
  0x58
};

#endif

static const unsigned char raw_X[] = {
    0x13, 0x77, 0x3b, 0x92, 0x11, 0x81, 0x6a, 0xba, 0x57, 0xeb, 0x4d, 0x30, 0x77, 0x90, 0xd1, 0x30, 
    0xc8, 0x75, 0xe4, 0x9e, 0x75, 0xeb, 0x20, 0x48, 0x9e, 0x7d, 0xe0, 0x2a, 0x8b, 0x69, 0x4f, 0xb8, 
    0xfc, 0x99, 0x0b, 0x4e, 0xeb, 0x2a, 0xe0, 0xaa, 0xc3, 0x75, 0x5e, 0xe5, 0x7e, 0x66, 0x66, 0x5f, 
    0x36, 0x30, 0x35, 0x5a, 0x37, 0x62, 0x10, 0x92, 0x81, 0x71, 0x82, 0x82, 0x78, 0x8a, 0xc7, 0xac, 
    0x47, 0x43, 0x6d, 0x49, 0x6e, 0xa8, 0x54, 0xe7, 0x5e, 0x27, 0xd0, 0xc1, 0x29, 0x79, 0xbe, 0x65, 
    0x87, 0x69, 0xff, 0xcb, 0xa8, 0x6c, 0x01, 0x9c, 0xed, 0x35, 0xe6, 0x9a, 0xff, 0xf4, 0xf9, 0xfd, 
    0xb2, 0xb7, 0xbd, 0x01, 0x3e, 0x99, 0xa4, 0x9b, 0x89, 0xe8, 0xa0, 0xd5, 0x35, 0x45, 0xa8, 0x44, 
    0xbc, 0x9f, 0x57, 0x30, 0xea, 0xca, 0x86, 0xa9, 0x6c, 0xe3, 0x7a, 0xc6, 0x47, 0xa4, 0xdc, 0x3a, 
    0xf8, 0x94, 0xee, 0xec, 0xbc, 0xb2, 0x09, 0xb8, 0xff, 0x9e, 0x39, 0x2a, 0x86, 0x6b, 0x46, 0x74, 
    0x4a, 0x9c, 0xb6, 0x47, 0x10, 0x8d, 0x7f, 0xd3, 0xf4, 0xb6, 0xa8, 0x6a, 0x9b, 0x2b, 0xbd, 0x2d, 
    0xa9, 0x2b, 0x99, 0xab, 0x80, 0x7a, 0x93, 0x9f, 0x10, 0x88, 0xdd, 0x0c, 0xfa, 0x04, 0xf9, 0xca, 
    0xca, 0xa8, 0x07, 0xbd, 0xab, 0x85, 0xcd, 0x64, 0xab, 0x4c, 0x6f, 0xd2, 0x3d, 0x32, 0xce, 0x9e, 
    0x25, 0x01, 0x1a, 0x4b, 0xe0, 0xc2, 0xdc, 0x95, 0xa3, 0x6c, 0x92, 0x4f, 0xf3, 0x0e, 0x3a, 0x90, 
    0xd6, 0xf9, 0x97, 0x21, 0xc0, 0x59, 0x34, 0x54, 0x37, 0x29, 0xb2, 0x8c, 0x32, 0xac, 0xa4, 0xc3, 
    0x6c, 0x34, 0x24, 0x75, 0xce, 0x3f, 0x87, 0xf0, 0x79, 0x04, 0x20, 0x6c, 0xd1, 0xbb, 0x59, 0x37, 
    0xbd, 0x92, 0x6b, 0xc5, 0xff, 0x0e, 0xe8, 0x6a, 0x77, 0xd7, 0x00, 0xe1, 0x2f, 0xce, 0x0c, 0xb0, 
    0xe5, 0x16, 0xa2, 0xf5, 0x12, 0x9c, 0x65, 0x41, 0x83, 0x27, 0x17, 0x55, 0xfa, 0x8f, 0xdb, 0x6b, 
    0x0f, 0x51, 0xb0, 0xfd, 0xde, 0xde, 0xd1, 0x60, 0x4c, 0x30, 0xe8, 0x18, 0x67, 0xcc, 0xa8, 0x46, 
    0x02, 0x90, 0xc2, 0xbb, 0x09, 0xd9, 0x57, 0x5c, 0x8f, 0x4b, 0xea, 0xe0, 0xdc, 0x96, 0x99, 0x55, 
    0xe7, 0x0c, 0xa0, 0xc0, 0x78, 0x65, 0xad, 0xd6, 0xc1, 0xfe, 0xd8, 0x71, 0xa0, 0xc6, 0x63, 0xf7, 
    0x83, 0xc6, 0x22, 0x4e, 0x90, 0x7d, 0xe8, 0x51, 0x05, 0x4f, 0x31, 0xbc, 0xf4, 0xd9, 0xd4, 0x8e, 
    0xc3, 0x6b, 0x11, 0x28, 0xf3, 0xa9, 0xad, 0x75, 0xbf, 0x1f, 0x77, 0xed, 0x4b, 0xd7, 0x07, 0x8d, 
    0xd2, 0xb7, 0xf0, 0x51, 0xb1, 0xc0, 0x12, 0x56, 0xd0, 0xee, 0x44, 0xf0, 0x22, 0x34, 0xcb, 0xe5, 
    0x8e, 0xe8, 0x4a, 0x7f, 0x3a, 0x38, 0x34, 0x1c, 0x9a, 0xf2, 0x98, 0x59, 0xaa, 0xc0, 0x7c, 0x1b
};
static const unsigned char raw_Y[] = {
    0x01, 0x00, 0x01
};
static const unsigned char raw_M[] = {
    0xa3, 0x85, 0xa3, 0x59, 0x7d, 0x1e, 0x5f, 0x25, 0xf9, 0x1b, 0x95, 0x6b, 0x35, 0x95, 0x0e, 0x36, 
    0xbf, 0xc5, 0x3f, 0xe1, 0x6e, 0x0a, 0x09, 0xfd, 0xf7, 0x99, 0xe8, 0xd6, 0x31, 0x71, 0x01, 0x01, 
    0x1a, 0x16, 0x15, 0x58, 0x21, 0x0b, 0xcc, 0xaa, 0xa0, 0xb2, 0x1f, 0x8e, 0xed, 0x74, 0xcc, 0x97, 
    0x66, 0x22, 0xce, 0x13, 0x3a, 0xe6, 0xa1, 0x26, 0x5f, 0xf5, 0xf1, 0xde, 0x7d, 0xd1, 0xc9, 0x31, 
    0xc6, 0x3d, 0x81, 0x0e, 0xe2, 0xdb, 0xf7, 0x61, 0xd1, 0x5d, 0x26, 0x10, 0x56, 0xb9, 0x72, 0x1c, 
    0x2c, 0x0a, 0xb8, 0x0f, 0x6c, 0xab, 0x19, 0x94, 0x28, 0x40, 0x69, 0x3b, 0xdb, 0x42, 0x3c, 0x84, 
    0x39, 0x18, 0xe3, 0x87, 0xa4, 0xce, 0x84, 0xcc, 0x3c, 0xab, 0x75, 0x54, 0x18, 0x62, 0x2d, 0x05, 
    0x88, 0x7d, 0xa2, 0x9a, 0x34, 0xbc, 0x8e, 0xfa, 0x9d, 0x89, 0xb2, 0x1a, 0x7d, 0x60, 0xcc, 0xcd, 
    0x68, 0xe5, 0x79, 0x04, 0x58, 0x98, 0x10, 0xcd, 0x88, 0xee, 0x7f, 0x7d, 0x6e, 0xc3, 0x32, 0x3d, 
    0x8f, 0x47, 0x20, 0x43, 0x53, 0x3c, 0x06, 0xf7, 0x21, 0xd2, 0x19, 0x3a, 0x78, 0xcd, 0x9e, 0xdb, 
    0x06, 0x94, 0xaf, 0xc7, 0x8c, 0xe1, 0x23, 0xf0, 0x33, 0x5d, 0x50, 0x4c, 0x58, 0x42, 0xe7, 0xca, 
    0x36, 0x23, 0x07, 0x4a, 0xd2, 0x20, 0x91, 0x03, 0x48, 0x87, 0x20, 0xfc, 0xf7, 0x97, 0xc7, 0xca, 
    0x8a, 0x42, 0x17, 0x0a, 0x41, 0x72, 0x24, 0x40, 0x38, 0x9d, 0x05, 0x4c, 0x3a, 0x21, 0x90, 0x68, 
    0xda, 0xc1, 0x22, 0x3a, 0x88, 0x7c, 0x2f, 0x8a, 0x55, 0x97, 0xca, 0xf6, 0xca, 0xf6, 0xe4, 0x2a, 
    0x51, 0xc3, 0xec, 0xcf, 0x97, 0x31, 0x70, 0x1e, 0x4c, 0x0a, 0x9a, 0x9d, 0x2e, 0x2c, 0x3f, 0xf9, 
    0xbe, 0x58, 0x20, 0x11, 0x21, 0xe1, 0x3d, 0x62, 0x39, 0xb5, 0x03, 0x46, 0xe7, 0x69, 0x62, 0x31, 
    0xd2, 0xcc, 0x6f, 0xee, 0xf3, 0x5d, 0xe5, 0x21, 0xb7, 0x8b, 0x3a, 0x7b, 0x31, 0x7b, 0xa8, 0x54, 
    0xa3, 0xf8, 0x63, 0xf0, 0x43, 0xa1, 0xc4, 0x69, 0x47, 0x66, 0xfb, 0x68, 0xa4, 0x8f, 0x9e, 0xba, 
    0xe4, 0xa7, 0xf1, 0x9c, 0x17, 0x25, 0xcf, 0xb6, 0xc1, 0x78, 0x41, 0x88, 0x13, 0x4f, 0xff, 0x56, 
    0x4b, 0x90, 0x9d, 0x01, 0x36, 0x35, 0x62, 0xf7, 0xb3, 0x32, 0xb1, 0x80, 0x62, 0x71, 0x1f, 0x68, 
    0x58, 0x02, 0x03, 0xb6, 0x50, 0x32, 0xf5, 0xe5, 0x2d, 0xfb, 0x10, 0x4d, 0xbb, 0x04, 0x80, 0xfa, 
    0x84, 0x20, 0x69, 0x03, 0xaa, 0x4d, 0xb3, 0xb3, 0xd6, 0x5d, 0xfb, 0x7b, 0x9a, 0x7e, 0xf8, 0xc5, 
    0x8a, 0x00, 0x2d, 0x10, 0xea, 0xa2, 0xb7, 0x16, 0x51, 0x2b, 0xc5, 0x8a, 0x19, 0xf1, 0x84, 0x18, 
    0x26, 0xd7, 0x04, 0x7c, 0x65, 0xbc, 0xeb, 0xa5, 0xe3, 0x59, 0x10, 0xb6, 0x0b, 0x23, 0x78, 0x25
};
static const unsigned char raw_Rinv[] = {
    0x47, 0xad, 0xbc, 0xb3, 0x04, 0xce, 0x4d, 0x60, 0x67, 0x05, 0xa4, 0xff, 0x6c, 0xfc, 0xd5, 0x21, 
    0x05, 0x09, 0x65, 0xf9, 0xfc, 0x18, 0x69, 0x64, 0x9b, 0x62, 0x67, 0x7f, 0xc4, 0x44, 0x56, 0x76, 
    0xfc, 0x9b, 0x7b, 0x49, 0x4f, 0xc7, 0xfd, 0xc1, 0xd9, 0x9e, 0xf0, 0xe9, 0xb4, 0x79, 0x1b, 0xcd, 
    0x31, 0x7e, 0x01, 0x21, 0xd7, 0xec, 0xb9, 0x9d, 0xf6, 0x88, 0x9a, 0x89, 0x60, 0x30, 0xcd, 0xb7, 
    0x8b, 0x50, 0x35, 0xbf, 0x63, 0x0f, 0x50, 0x41, 0x64, 0x2f, 0xc2, 0x13, 0xe4, 0x29, 0x57, 0xf8, 
    0x90, 0xaf, 0xa5, 0x96, 0x61, 0x0b, 0x78, 0xf4, 0xc8, 0x29, 0x9e, 0x14, 0xd5, 0xc9, 0xca, 0x55, 
    0xfe, 0x9c, 0xcf, 0xeb, 0x44, 0x7f, 0xe5, 0x8b, 0xd6, 0x40, 0x27, 0xc3, 0xf9, 0xec, 0xcb, 0xd2, 
    0x31, 0x20, 0x69, 0x4e, 0xeb, 0xbb, 0xe7, 0xe0, 0xed, 0x61, 0x88, 0x77, 0x57, 0x79, 0xfb, 0xf1, 
    0x3f, 0xc7, 0xa7, 0x86, 0x74, 0x3f, 0xca, 0xaf, 0x3b, 0x4c, 0xd0, 0xfe, 0xa5, 0x23, 0x9a, 0x31, 
    0xdd, 0xf4, 0x9e, 0x92, 0x6f, 0x15, 0xc9, 0xcd, 0x8e, 0xd4, 0xf6, 0xa1, 0x34, 0xcb, 0xa3, 0x63, 
    0x7b, 0x83, 0xeb, 0xe2, 0xcb, 0x27, 0x56, 0xed, 0x6d, 0x32, 0xfc, 0xd6, 0xfc, 0x90, 0xe3, 0xe5, 
    0x60, 0x08, 0xc7, 0xde, 0xb4, 0xe7, 0x0b, 0x34, 0xb5, 0xd1, 0x6a, 0xb0, 0x6d, 0xbe, 0x8b, 0x89, 
    0x47, 0x13, 0x28, 0xa1, 0xaa, 0xe3, 0x9b, 0xaa, 0x33, 0x91, 0x4b, 0x96, 0xc6, 0x26, 0x02, 0x0b, 
    0x5c, 0x7b, 0x0b, 0xe5, 0x18, 0xbe, 0x70, 0x62, 0x31, 0xa7, 0xd0, 0x1b, 0xd0, 0x67, 0x83, 0xca, 
    0xc9, 0x74, 0x79, 0xc7, 0x44, 0xab, 0x79, 0xa9, 0x57, 0xcc, 0xfc, 0xfd, 0x45, 0xd7, 0x4f, 0xea, 
    0x1e, 0xb6, 0xcc, 0x22, 0x7a, 0x4c, 0x87, 0x42, 0x14, 0x26, 0xbc, 0x44, 0x69, 0xba, 0x7d, 0x92, 
    0x02, 0x7b, 0x9c, 0xdd, 0x68, 0x0b, 0x8e, 0x84, 0x3d, 0xaf, 0x94, 0x59, 0xe7, 0x11, 0xea, 0xcb, 
    0x49, 0xb0, 0x79, 0xc2, 0xae, 0xb4, 0x4c, 0x46, 0xbb, 0xba, 0xad, 0xd9, 0x11, 0x1d, 0xa8, 0xe3, 
    0x10, 0xde, 0xfe, 0xb0, 0x8d, 0x77, 0xdb, 0x1d, 0x2c, 0x34, 0xc8, 0x34, 0x41, 0x85, 0x21, 0x03, 
    0xdf, 0xa9, 0x61, 0x32, 0xa8, 0xa4, 0x6a, 0xcc, 0xd6, 0x47, 0xb8, 0x04, 0x72, 0x67, 0x3b, 0x7a, 
    0x2c, 0xb8, 0xe4, 0x26, 0xb2, 0xa6, 0xf6, 0x09, 0xba, 0xc3, 0xe5, 0x88, 0xec, 0x67, 0xb4, 0xa2, 
    0xfa, 0x8a, 0x83, 0xc0, 0x71, 0x15, 0x2f, 0x1e, 0xed, 0x17, 0x3c, 0x2f, 0x1c, 0xe0, 0x2d, 0x6b, 
    0x67, 0x86, 0x6a, 0x09, 0x73, 0x2d, 0x8d, 0x35, 0xfa, 0xe5, 0x3b, 0x95, 0xb7, 0x49, 0x51, 0xa3, 
    0x34, 0x89, 0xca, 0x81, 0x77, 0x80, 0x05, 0xdd, 0xb7, 0xad, 0xb4, 0xd7, 0xe3, 0xe7, 0xfe, 0x16
};
static const uint32_t Mprime = 2888571987;
static const size_t num_words = 96;

static const unsigned char raw_memblock_X[] = {
    0x1b, 0x7c, 0xc0, 0xaa, 0x59, 0x98, 0xf2, 0x9a, 0x1c, 0x34, 0x38, 0x3a, 0x7f, 0x4a, 0xe8, 0x8e, 
    0xe5, 0xcb, 0x34, 0x22, 0xf0, 0x44, 0xee, 0xd0, 0x56, 0x12, 0xc0, 0xb1, 0x51, 0xf0, 0xb7, 0xd2, 
    0x8d, 0x07, 0xd7, 0x4b, 0xed, 0x77, 0x1f, 0xbf, 0x75, 0xad, 0xa9, 0xf3, 0x28, 0x11, 0x6b, 0xc3, 
    0x8e, 0xd4, 0xd9, 0xf4, 0xbc, 0x31, 0x4f, 0x05, 0x51, 0xe8, 0x7d, 0x90, 0x4e, 0x22, 0xc6, 0x83, 
    0xf7, 0x63, 0xc6, 0xa0, 0x71, 0xd8, 0xfe, 0xc1, 0xd6, 0xad, 0x65, 0x78, 0xc0, 0xa0, 0x0c, 0xe7, 
    0x55, 0x99, 0x96, 0xdc, 0xe0, 0xea, 0x4b, 0x8f, 0x5c, 0x57, 0xd9, 0x09, 0xbb, 0xc2, 0x90, 0x02, 
    0x46, 0xa8, 0xcc, 0x67, 0x18, 0xe8, 0x30, 0x4c, 0x60, 0xd1, 0xde, 0xde, 0xfd, 0xb0, 0x51, 0x0f, 
    0x6b, 0xdb, 0x8f, 0xfa, 0x55, 0x17, 0x27, 0x83, 0x41, 0x65, 0x9c, 0x12, 0xf5, 0xa2, 0x16, 0xe5, 
    0xb0, 0x0c, 0xce, 0x2f, 0xe1, 0x00, 0xd7, 0x77, 0x6a, 0xe8, 0x0e, 0xff, 0xc5, 0x6b, 0x92, 0xbd, 
    0x37, 0x59, 0xbb, 0xd1, 0x6c, 0x20, 0x04, 0x79, 0xf0, 0x87, 0x3f, 0xce, 0x75, 0x24, 0x34, 0x6c, 
    0xc3, 0xa4, 0xac, 0x32, 0x8c, 0xb2, 0x29, 0x37, 0x54, 0x34, 0x59, 0xc0, 0x21, 0x97, 0xf9, 0xd6, 
    0x90, 0x3a, 0x0e, 0xf3, 0x4f, 0x92, 0x6c, 0xa3, 0x95, 0xdc, 0xc2, 0xe0, 0x4b, 0x1a, 0x01, 0x25, 
    0x9e, 0xce, 0x32, 0x3d, 0xd2, 0x6f, 0x4c, 0xab, 0x64, 0xcd, 0x85, 0xab, 0xbd, 0x07, 0xa8, 0xca, 
    0xca, 0xf9, 0x04, 0xfa, 0x0c, 0xdd, 0x88, 0x10, 0x9f, 0x93, 0x7a, 0x80, 0xab, 0x99, 0x2b, 0xa9, 
    0x2d, 0xbd, 0x2b, 0x9b, 0x6a, 0xa8, 0xb6, 0xf4, 0xd3, 0x7f, 0x8d, 0x10, 0x47, 0xb6, 0x9c, 0x4a, 
    0x74, 0x46, 0x6b, 0x86, 0x2a, 0x39, 0x9e, 0xff, 0xb8, 0x09, 0xb2, 0xbc, 0xec, 0xee, 0x94, 0xf8, 
    0x3a, 0xdc, 0xa4, 0x47, 0xc6, 0x7a, 0xe3, 0x6c, 0xa9, 0x86, 0xca, 0xea, 0x30, 0x57, 0x9f, 0xbc, 
    0x44, 0xa8, 0x45, 0x35, 0xd5, 0xa0, 0xe8, 0x89, 0x9b, 0xa4, 0x99, 0x3e, 0x01, 0xbd, 0xb7, 0xb2, 
    0xfd, 0xf9, 0xf4, 0xff, 0x9a, 0xe6, 0x35, 0xed, 0x9c, 0x01, 0x6c, 0xa8, 0xcb, 0xff, 0x69, 0x87, 
    0x65, 0xbe, 0x79, 0x29, 0xc1, 0xd0, 0x27, 0x5e, 0xe7, 0x54, 0xa8, 0x6e, 0x49, 0x6d, 0x43, 0x47, 
    0xac, 0xc7, 0x8a, 0x78, 0x82, 0x82, 0x71, 0x81, 0x92, 0x10, 0x62, 0x37, 0x5a, 0x35, 0x30, 0x36, 
    0x5f, 0x66, 0x66, 0x7e, 0xe5, 0x5e, 0x75, 0xc3, 0xaa, 0xe0, 0x2a, 0xeb, 0x4e, 0x0b, 0x99, 0xfc, 
    0xb8, 0x4f, 0x69, 0x8b, 0x2a, 0xe0, 0x7d, 0x9e, 0x48, 0x20, 0xeb, 0x75, 0x9e, 0xe4, 0x75, 0xc8, 
    0x30, 0xd1, 0x90, 0x77, 0x30, 0x4d, 0xeb, 0x57, 0xba, 0x6a, 0x81, 0x11, 0x92, 0x3b, 0x77, 0x13, 
};
static const unsigned char raw_memblock_Y[] = {
    0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
};
static const unsigned char raw_memblock_M[] = {
    0x25, 0x78, 0x23, 0x0b, 0xb6, 0x10, 0x59, 0xe3, 0xa5, 0xeb, 0xbc, 0x65, 0x7c, 0x04, 0xd7, 0x26, 
    0x18, 0x84, 0xf1, 0x19, 0x8a, 0xc5, 0x2b, 0x51, 0x16, 0xb7, 0xa2, 0xea, 0x10, 0x2d, 0x00, 0x8a, 
    0xc5, 0xf8, 0x7e, 0x9a, 0x7b, 0xfb, 0x5d, 0xd6, 0xb3, 0xb3, 0x4d, 0xaa, 0x03, 0x69, 0x20, 0x84, 
    0xfa, 0x80, 0x04, 0xbb, 0x4d, 0x10, 0xfb, 0x2d, 0xe5, 0xf5, 0x32, 0x50, 0xb6, 0x03, 0x02, 0x58, 
    0x68, 0x1f, 0x71, 0x62, 0x80, 0xb1, 0x32, 0xb3, 0xf7, 0x62, 0x35, 0x36, 0x01, 0x9d, 0x90, 0x4b, 
    0x56, 0xff, 0x4f, 0x13, 0x88, 0x41, 0x78, 0xc1, 0xb6, 0xcf, 0x25, 0x17, 0x9c, 0xf1, 0xa7, 0xe4, 
    0xba, 0x9e, 0x8f, 0xa4, 0x68, 0xfb, 0x66, 0x47, 0x69, 0xc4, 0xa1, 0x43, 0xf0, 0x63, 0xf8, 0xa3, 
    0x54, 0xa8, 0x7b, 0x31, 0x7b, 0x3a, 0x8b, 0xb7, 0x21, 0xe5, 0x5d, 0xf3, 0xee, 0x6f, 0xcc, 0xd2, 
    0x31, 0x62, 0x69, 0xe7, 0x46, 0x03, 0xb5, 0x39, 0x62, 0x3d, 0xe1, 0x21, 0x11, 0x20, 0x58, 0xbe, 
    0xf9, 0x3f, 0x2c, 0x2e, 0x9d, 0x9a, 0x0a, 0x4c, 0x1e, 0x70, 0x31, 0x97, 0xcf, 0xec, 0xc3, 0x51, 
    0x2a, 0xe4, 0xf6, 0xca, 0xf6, 0xca, 0x97, 0x55, 0x8a, 0x2f, 0x7c, 0x88, 0x3a, 0x22, 0xc1, 0xda, 
    0x68, 0x90, 0x21, 0x3a, 0x4c, 0x05, 0x9d, 0x38, 0x40, 0x24, 0x72, 0x41, 0x0a, 0x17, 0x42, 0x8a, 
    0xca, 0xc7, 0x97, 0xf7, 0xfc, 0x20, 0x87, 0x48, 0x03, 0x91, 0x20, 0xd2, 0x4a, 0x07, 0x23, 0x36, 
    0xca, 0xe7, 0x42, 0x58, 0x4c, 0x50, 0x5d, 0x33, 0xf0, 0x23, 0xe1, 0x8c, 0xc7, 0xaf, 0x94, 0x06, 
    0xdb, 0x9e, 0xcd, 0x78, 0x3a, 0x19, 0xd2, 0x21, 0xf7, 0x06, 0x3c, 0x53, 0x43, 0x20, 0x47, 0x8f, 
    0x3d, 0x32, 0xc3, 0x6e, 0x7d, 0x7f, 0xee, 0x88, 0xcd, 0x10, 0x98, 0x58, 0x04, 0x79, 0xe5, 0x68, 
    0xcd, 0xcc, 0x60, 0x7d, 0x1a, 0xb2, 0x89, 0x9d, 0xfa, 0x8e, 0xbc, 0x34, 0x9a, 0xa2, 0x7d, 0x88, 
    0x05, 0x2d, 0x62, 0x18, 0x54, 0x75, 0xab, 0x3c, 0xcc, 0x84, 0xce, 0xa4, 0x87, 0xe3, 0x18, 0x39, 
    0x84, 0x3c, 0x42, 0xdb, 0x3b, 0x69, 0x40, 0x28, 0x94, 0x19, 0xab, 0x6c, 0x0f, 0xb8, 0x0a, 0x2c, 
    0x1c, 0x72, 0xb9, 0x56, 0x10, 0x26, 0x5d, 0xd1, 0x61, 0xf7, 0xdb, 0xe2, 0x0e, 0x81, 0x3d, 0xc6, 
    0x31, 0xc9, 0xd1, 0x7d, 0xde, 0xf1, 0xf5, 0x5f, 0x26, 0xa1, 0xe6, 0x3a, 0x13, 0xce, 0x22, 0x66, 
    0x97, 0xcc, 0x74, 0xed, 0x8e, 0x1f, 0xb2, 0xa0, 0xaa, 0xcc, 0x0b, 0x21, 0x58, 0x15, 0x16, 0x1a, 
    0x01, 0x01, 0x71, 0x31, 0xd6, 0xe8, 0x99, 0xf7, 0xfd, 0x09, 0x0a, 0x6e, 0xe1, 0x3f, 0xc5, 0xbf, 
    0x36, 0x0e, 0x95, 0x35, 0x6b, 0x95, 0x1b, 0xf9, 0x25, 0x5f, 0x1e, 0x7d, 0x59, 0xa3, 0x85, 0xa3, 
};
static const unsigned char raw_memblock_RB[] = {
    0x16, 0xfe, 0xe7, 0xe3, 0xd7, 0xb4, 0xad, 0xb7, 0xdd, 0x05, 0x80, 0x77, 0x81, 0xca, 0x89, 0x34, 
    0xa3, 0x51, 0x49, 0xb7, 0x95, 0x3b, 0xe5, 0xfa, 0x35, 0x8d, 0x2d, 0x73, 0x09, 0x6a, 0x86, 0x67, 
    0x6b, 0x2d, 0xe0, 0x1c, 0x2f, 0x3c, 0x17, 0xed, 0x1e, 0x2f, 0x15, 0x71, 0xc0, 0x83, 0x8a, 0xfa, 
    0xa2, 0xb4, 0x67, 0xec, 0x88, 0xe5, 0xc3, 0xba, 0x09, 0xf6, 0xa6, 0xb2, 0x26, 0xe4, 0xb8, 0x2c, 
    0x7a, 0x3b, 0x67, 0x72, 0x04, 0xb8, 0x47, 0xd6, 0xcc, 0x6a, 0xa4, 0xa8, 0x32, 0x61, 0xa9, 0xdf, 
    0x03, 0x21, 0x85, 0x41, 0x34, 0xc8, 0x34, 0x2c, 0x1d, 0xdb, 0x77, 0x8d, 0xb0, 0xfe, 0xde, 0x10, 
    0xe3, 0xa8, 0x1d, 0x11, 0xd9, 0xad, 0xba, 0xbb, 0x46, 0x4c, 0xb4, 0xae, 0xc2, 0x79, 0xb0, 0x49, 
    0xcb, 0xea, 0x11, 0xe7, 0x59, 0x94, 0xaf, 0x3d, 0x84, 0x8e, 0x0b, 0x68, 0xdd, 0x9c, 0x7b, 0x02, 
    0x92, 0x7d, 0xba, 0x69, 0x44, 0xbc, 0x26, 0x14, 0x42, 0x87, 0x4c, 0x7a, 0x22, 0xcc, 0xb6, 0x1e, 
    0xea, 0x4f, 0xd7, 0x45, 0xfd, 0xfc, 0xcc, 0x57, 0xa9, 0x79, 0xab, 0x44, 0xc7, 0x79, 0x74, 0xc9, 
    0xca, 0x83, 0x67, 0xd0, 0x1b, 0xd0, 0xa7, 0x31, 0x62, 0x70, 0xbe, 0x18, 0xe5, 0x0b, 0x7b, 0x5c, 
    0x0b, 0x02, 0x26, 0xc6, 0x96, 0x4b, 0x91, 0x33, 0xaa, 0x9b, 0xe3, 0xaa, 0xa1, 0x28, 0x13, 0x47, 
    0x89, 0x8b, 0xbe, 0x6d, 0xb0, 0x6a, 0xd1, 0xb5, 0x34, 0x0b, 0xe7, 0xb4, 0xde, 0xc7, 0x08, 0x60, 
    0xe5, 0xe3, 0x90, 0xfc, 0xd6, 0xfc, 0x32, 0x6d, 0xed, 0x56, 0x27, 0xcb, 0xe2, 0xeb, 0x83, 0x7b, 
    0x63, 0xa3, 0xcb, 0x34, 0xa1, 0xf6, 0xd4, 0x8e, 0xcd, 0xc9, 0x15, 0x6f, 0x92, 0x9e, 0xf4, 0xdd, 
    0x31, 0x9a, 0x23, 0xa5, 0xfe, 0xd0, 0x4c, 0x3b, 0xaf, 0xca, 0x3f, 0x74, 0x86, 0xa7, 0xc7, 0x3f, 
    0xf1, 0xfb, 0x79, 0x57, 0x77, 0x88, 0x61, 0xed, 0xe0, 0xe7, 0xbb, 0xeb, 0x4e, 0x69, 0x20, 0x31, 
    0xd2, 0xcb, 0xec, 0xf9, 0xc3, 0x27, 0x40, 0xd6, 0x8b, 0xe5, 0x7f, 0x44, 0xeb, 0xcf, 0x9c, 0xfe, 
    0x55, 0xca, 0xc9, 0xd5, 0x14, 0x9e, 0x29, 0xc8, 0xf4, 0x78, 0x0b, 0x61, 0x96, 0xa5, 0xaf, 0x90, 
    0xf8, 0x57, 0x29, 0xe4, 0x13, 0xc2, 0x2f, 0x64, 0x41, 0x50, 0x0f, 0x63, 0xbf, 0x35, 0x50, 0x8b, 
    0xb7, 0xcd, 0x30, 0x60, 0x89, 0x9a, 0x88, 0xf6, 0x9d, 0xb9, 0xec, 0xd7, 0x21, 0x01, 0x7e, 0x31, 
    0xcd, 0x1b, 0x79, 0xb4, 0xe9, 0xf0, 0x9e, 0xd9, 0xc1, 0xfd, 0xc7, 0x4f, 0x49, 0x7b, 0x9b, 0xfc, 
    0x76, 0x56, 0x44, 0xc4, 0x7f, 0x67, 0x62, 0x9b, 0x64, 0x69, 0x18, 0xfc, 0xf9, 0x65, 0x09, 0x05, 
    0x21, 0xd5, 0xfc, 0x6c, 0xff, 0xa4, 0x05, 0x67, 0x60, 0x4d, 0xce, 0x04, 0xb3, 0xbc, 0xad, 0x47, 
};

// static inline void mem_block_to_mpi(mbedtls_mpi *x, uint32_t mem_base, size_t num_words)
// {
//     assert(x->MBEDTLS_PRIVATE(n) >= num_words);

//     /* Copy data from memory block registers */
//     esp_dport_access_read_buffer(x->MBEDTLS_PRIVATE(p), mem_base, num_words);

//     /* Zero any remaining limbs in the bignum, if the buffer is bigger
//        than num_words */
//     for (size_t i = num_words; i < x->MBEDTLS_PRIVATE(n); i++) {
//         x->MBEDTLS_PRIVATE(p[i]) = 0;
//     }
// }

static inline void raw_to_mem_block(uint32_t mem_base, const unsigned char *data, size_t hw_words)
{
    uint32_t copy_words = hw_words;

    /* Copy MPI data to memory block registers */
    for (uint32_t i = 0; i < copy_words; i++) {
        DPORT_REG_WRITE(mem_base + i * 4, (uint32_t)(data + (4 * i)));
    }

#if _INTERNAL_DEBUG_PURPOSE
    /*
     * With Xtensa GCC 11.2.0 (from ESP-IDF v5.x), it was observed that above zero initialization
     * loop gets optimized to `memset` call from the ROM library. This was causing an issue that
     * specific write (store) operation to the MPI peripheral block was getting lost erroneously.
     * Following data re-verify loop could catch it during runtime.
     *
     * As a workaround, we are using DPORT_WRITE_REG (volatile writes) wrappers to write to
     * the MPI peripheral.
     *
     */

    //for (uint32_t i = copy_words; i < hw_words; i++) { assert(pbase[i] == 0); }
#endif
}

/* Begin an RSA operation. op_reg specifies which 'START' register
   to write to.
*/
static inline void start_op(uint32_t op_reg)
{
    /* Clear interrupt status */
    DPORT_REG_WRITE(RSA_INTERRUPT_REG, 1);

    /* Note: above REG_WRITE includes a memw, so we know any writes
       to the memory blocks are also complete. */

    DPORT_REG_WRITE(op_reg, 1);
}

/* Wait for an RSA operation to complete.
*/
static inline void wait_op_complete(void)
{
    while (DPORT_REG_READ(RSA_INTERRUPT_REG) != 1)
    { }

    /* clear the interrupt */
    DPORT_REG_WRITE(RSA_INTERRUPT_REG, 1);
}

/* Read result from last MPI operation */
static void janis_esp_mpi_read_result_hw_op(mbedtls_mpi *Z, size_t z_words)
{
    wait_op_complete();
    //mem_block_to_mpi(Z, RSA_MEM_Z_BLOCK_BASE, z_words);
}

/* Z = (X ^ Y) mod M
*/
static void janis_esp_mpi_exp_mpi_mod_hw_op(mbedtls_mpi_uint Mprime, size_t _num_words)
{
    REG_WRITE(RSA_LENGTH_REG, (_num_words - 1));

    /* Load M, X, Rinv, Mprime (Mprime is mod 2^32) */
    raw_to_mem_block(RSA_MEM_X_BLOCK_BASE, raw_memblock_X, num_words);
    raw_to_mem_block(RSA_MEM_Y_BLOCK_BASE, raw_memblock_Y, num_words);
    raw_to_mem_block(RSA_MEM_M_BLOCK_BASE, raw_memblock_M, num_words);
    raw_to_mem_block(RSA_MEM_RB_BLOCK_BASE, raw_memblock_RB, num_words);
    REG_WRITE(RSA_M_DASH_REG, Mprime);

    /* Enable acceleration options */
    REG_WRITE(RSA_CONSTANT_TIME_REG, 0);
    REG_WRITE(RSA_SEARCH_ENABLE_REG, 0);
    REG_WRITE(RSA_SEARCH_POS_REG, (_num_words * 32) - 1);

    /* Execute first stage montgomery multiplication */
    start_op(RSA_MODEXP_START_REG);


    REG_WRITE(RSA_SEARCH_ENABLE_REG, 0);
}

static int myrand(void *rng_state, unsigned char *output, size_t len)
{
    size_t use_len;
    int rnd;

    if (rng_state != NULL) {
        rng_state  = NULL;
    }

    while (len > 0) {
        use_len = len;
        if (use_len > sizeof(int)) {
            use_len = sizeof(int);
        }

        rnd = rand();
        memcpy(output, &rnd, use_len);
        output += use_len;
        len -= use_len;
    }

    return 0;
}

int sign() {
    // openssl rsa -inform PEM -text -noout -in private_key.pem
    // then do some xxd-based magic

    struct mbedtls_rsa_context rsa_ctx;
    mbedtls_rsa_init(&rsa_ctx);
    // define rsa_keypair_t struct type
    struct rsa_keypair_t {
        uint8_t *n;
        size_t n_len;
        uint8_t *e;
        size_t e_len;
        uint8_t *d;
        size_t d_len;
        uint8_t *p;
        size_t p_len;
        uint8_t *q;
        size_t q_len;
        uint8_t *dp;
        size_t dp_len;
        uint8_t *dq;
        size_t dq_len;
        uint8_t *qp;
        size_t qp_len;
    };

    // init rsa_keypair
    struct rsa_keypair_t rsa_keypair = {
        .n = (uint8_t *)rsa_n,
        .n_len = sizeof(rsa_n),
        .e = (uint8_t *)rsa_e,
        .e_len = sizeof(rsa_e),
        .d = (uint8_t *)rsa_d,
        .d_len = sizeof(rsa_d),
        .p = (uint8_t *)rsa_p,
        .p_len = sizeof(rsa_p),
        .q = (uint8_t *)rsa_q,
        .q_len = sizeof(rsa_q),
        .dp = (uint8_t *)rsa_dp,
        .dp_len = sizeof(rsa_dp),
        .dq = (uint8_t *)rsa_dq,
        .dq_len = sizeof(rsa_dq),
        .qp = (uint8_t *)rsa_qp,
        .qp_len = sizeof(rsa_qp),
    };
    // import rsa private key
    mbedtls_rsa_import_raw(&rsa_ctx, rsa_keypair.n, rsa_keypair.n_len, rsa_keypair.p, rsa_keypair.p_len, rsa_keypair.q, rsa_keypair.q_len, rsa_keypair.d, rsa_keypair.d_len, rsa_keypair.e, rsa_keypair.e_len);
    mbedtls_rsa_complete(&rsa_ctx);
    // check public key
    if (mbedtls_rsa_check_pubkey(&rsa_ctx) != 0) {
        ESP_LOGE(TAG, "mbedtls_rsa_check_pubkey failed");
        return -1;
    }
    // check private key
    if (mbedtls_rsa_check_privkey(&rsa_ctx) != 0) {
        ESP_LOGE(TAG, "mbedtls_rsa_check_privkey failed");
        return -1;
    }
    uint8_t *input = malloc(mbedtls_rsa_get_len(&rsa_ctx));
    uint8_t *output = malloc(mbedtls_rsa_get_len(&rsa_ctx));
    memset(input, 0x01, mbedtls_rsa_get_len(&rsa_ctx));
    input[mbedtls_rsa_get_len(&rsa_ctx) / 2] = 0x01;
    memset(output, 0x00, mbedtls_rsa_get_len(&rsa_ctx));
    {
        ESP_LOGI(TAG, "sign start");
        // get start time
        uint64_t start = esp_timer_get_time();
        const int repeat = 0;
        uint64_t *delta_time = malloc(repeat * sizeof(uint64_t));
        for (int i = 0; i < repeat; i++) {
            int result = mbedtls_rsa_private(&rsa_ctx, myrand, NULL, input, output);
            if (result != 0) {
                char buf[1024];
                mbedtls_strerror(result, buf, sizeof(buf));
                //ESP_LOGE(TAG, "mbedtls_rsa_private[%d] failed with 0x%x - %s", i, -result, buf);
            }
            // get end time
            uint64_t end = esp_timer_get_time();
            // calculate time delta
            uint64_t delta = end - start;
            delta_time[i] = delta;
            // get time for current iteration
            uint64_t delta_iter = delta - (i > 0 ? delta_time[i - 1] : 0);
            // convert time delta to milliseconds
            // log time taken
            //ESP_LOGI(TAG, "sign %d took %llu ms, %llu us per iteration", i, delta, delta_iter);
        }
        free(delta_time);
        // get end time
        uint64_t end = esp_timer_get_time();
        // calculate time delta
        uint64_t delta = end - start;
        // convert time delta to milliseconds
        double delta_ms = (double)delta / 1000;
        // log time taken
        if (repeat != 0) {
            ESP_LOGI(TAG, "sign took %f ms, %f ms per iteration", delta_ms, delta_ms / repeat);
        }
    }
    free(input);
    free(output);
    mbedtls_rsa_free(&rsa_ctx);

    (void)raw_X;
    (void)raw_Y;
    (void)raw_M;
    (void)raw_Rinv;
    (void)num_words;
    (void)Mprime;
#if CONFIG_MBEDTLS_HARDWARE_MPI
    {
        uint64_t start = esp_timer_get_time();

        esp_mpi_enable_hardware_hw_op();
        const int repeat = 5;
        // do the math
        // Z = (X ^ Y) mod M
        for (int i = 0; i < repeat; i++) {
            janis_esp_mpi_exp_mpi_mod_hw_op(Mprime, num_words);
            wait_op_complete();
        }
        esp_mpi_disable_hardware_hw_op();

        uint64_t end = esp_timer_get_time();
        // calculate time delta
        uint64_t delta = end - start;
        // convert time delta to milliseconds
        double delta_ms = (double)delta / 1000;
        // log time taken
        if (repeat != 0) {
            ESP_LOGI(TAG, "exp took %f ms, %f ms per iteration", delta_ms, delta_ms / repeat);
        }
    }
#endif
    return 0;
}

void app_main(void)
{

    /* Configure the peripheral according to the LED type */
    configure_led();

    while (1) {
        //ESP_LOGI(TAG, "Turning the LED %s!", s_led_state == true ? "ON" : "OFF");
        blink_led();
        sign();
        /* Toggle the LED state */
        s_led_state = !s_led_state;
        vTaskDelay(CONFIG_BLINK_PERIOD / portTICK_PERIOD_MS);
    }
}

